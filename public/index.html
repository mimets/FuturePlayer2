<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>FuturePlayer Premium</title>
<style>
body { font-family: Arial, sans-serif; background:#111; color:#fff; text-align:center; padding:40px;}
button { padding:10px 20px; background:#1DB954; color:white; border:none; border-radius:5px; cursor:pointer; margin:5px;}
button:hover { background:#1ed760;}
input { padding:8px; width:300px; margin:10px;}
audio { margin-top:20px; width:90%; }
</style>
</head>
<body>
<h1>ðŸŽµ FuturePlayer Premium</h1>
<a href="/login"><button>Accedi con Spotify Premium</button></a>
<input type="text" id="searchInput" placeholder="Cerca artista o brano..." />
<button onclick="searchTracks()">Cerca</button>
<audio id="player" controls></audio>
<div id="resultsContainer"></div>

<script>
async function searchTracks(){
  const query = document.getElementById('searchInput').value;
  if(!query) return;

  try {
    const res = await fetch(`/search?q=${encodeURIComponent(query)}`);
    const tracks = await res.json();
    const container = document.getElementById('resultsContainer');
    container.innerHTML='';

    if(tracks.length===0){
      container.textContent='Nessun risultato trovato';
      return;
    }

    tracks.forEach(track=>{
      if(track.preview_url){
        const btn = document.createElement('button');
        btn.textContent = track.name + ' - ' + track.artists.map(a=>a.name).join(', ');
        btn.onclick = ()=>{ 
          document.getElementById('player').src=track.preview_url;
          document.getElementById('player').play();
        };
        container.appendChild(btn);
      }
    });

  } catch(err){
    console.error('Errore nella ricerca:',err);
  }
}
</script>
</body>
</html>
