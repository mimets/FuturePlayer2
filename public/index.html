<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>FuturePlayer</title>
  <style>
    body { font-family: Arial, sans-serif; background:#111; color:#fff; text-align:center; padding:40px;}
    button { padding:10px 20px; background:#1DB954; color:white; border:none; border-radius:5px; cursor:pointer; margin:5px;}
    button:hover { background:#1ed760;}
    audio { margin-top:20px; width:90%;}
    .track { margin:10px 0; }
  </style>
</head>
<body>
  <h1>ðŸŽµ FuturePlayer</h1>
  <audio id="player" controls></audio>
  <div id="playlistContainer"></div>

  <script>
    async function loadPlaylists() {
      const res = await fetch('/playlists');
      const playlists = await res.json();
      const container = document.getElementById('playlistContainer');
      container.innerHTML = '';

      playlists.forEach(pl => {
        const div = document.createElement('div');
        div.innerHTML = `<h3>${pl.name}</h3>`;
        const trackList = document.createElement('div');

        // Prendiamo solo le prime 5 tracce preview
        pl.tracks.items.slice(0,5).forEach(trackItem => {
          const track = trackItem.track;
          if(track && track.preview_url) {
            const btn = document.createElement('button');
            btn.textContent = track.name;
            btn.onclick = () => {
              document.getElementById('player').src = track.preview_url;
              document.getElementById('player').play();
            };
            trackList.appendChild(btn);
          }
        });

        div.appendChild(trackList);
        container.appendChild(div);
      });
    }

    loadPlaylists();
  </script>
</body>
</html>
